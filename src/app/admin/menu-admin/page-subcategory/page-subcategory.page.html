<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start" (click)="backMenu()">
      <ion-icon name="arrow-back" class="icon-toolbar"></ion-icon>
    </ion-buttons>
    <ion-title>Subcategor칤as</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <br />
  <!-- Selector de categor칤a -->
  <ion-grid>
    <ion-row>
      <ion-col size="12" size-sm="6" size-md="4" size-lg="3">
        <ion-select label="Elegir Categor칤a" label-placement="stacked" fill="outline" [(ngModel)]="selectedCategoryId"
          (ionChange)="cargarSubcategorias()">
          <ion-select-option value="">Mostrar todos</ion-select-option>
          <ion-select-option *ngFor="let category of categoriesList" [value]="category.id">
            {{ category.name }}
          </ion-select-option>
        </ion-select>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Mostrar todas las categor칤as y sus subcategor칤as -->
  <ng-container *ngIf="selectedCategoryId === ''">
    <ion-card *ngFor="let category of categoriesList" class="category-card">
      <ion-card-header>
        <ion-card-title class="ion-text-center categorytitle">{{ category.name }}</ion-card-title>
      </ion-card-header>

      <!-- Tabla de subcategor칤as -->
      <ion-card class="row-header">
        <ion-grid fixed>
          <ion-row class="ion-text-center">
            <ion-col size="1">N춿</ion-col>
            <ion-col size="3">Subcategor칤a</ion-col>
            <ion-col size="6">Descripci칩n</ion-col>
            <ion-col size="2">Acciones</ion-col>
          </ion-row>
        </ion-grid>
      </ion-card>

      <!-- Lista de subcategor칤as -->
      <ion-card *ngFor="let subcategory of category.subcategories; let indice = index" class="row-content">
        <ion-grid fixed>
          <ion-row class="ion-text-center">
            <ion-col size="1">{{ indice + 1 }}</ion-col>
            <ion-col size="3">{{ subcategory.name }}</ion-col>
            <ion-col size="6">{{ subcategory.description }}</ion-col>
            <ion-col size="2">
              <ion-icon name="pencil-outline" button tappable (click)="editarSubcategoria(subcategory)"
                class="pencil-icon">
              </ion-icon>
              <ion-icon name="trash" button tappable (click)="alertaEliminarSubcategoria(subcategory)"
                class="trash-icon">
              </ion-icon>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card>

      <!-- Bot칩n para agregar una nueva subcategor칤a -->
            <ion-button (click)="nuevaSubcategoria(category.id)" expand="block" fill="outline" shape="round" class="add_subcategory_button">
              <ion-icon name="add" class="icon-add"></ion-icon>
              Agregar Subcategor칤a
            </ion-button>
    </ion-card>
  </ng-container>

  <!-- Mostrar una categor칤a espec칤fica y sus subcategor칤as -->
  <ng-container *ngIf="selectedCategoryId !== ''">
    <ion-card *ngIf="selectedCategory" class="category-card">
      <ion-card-header>
        <ion-card-title class="ion-text-center categorytitle">{{ selectedCategory.name }}</ion-card-title>
      </ion-card-header>

      <!-- Tabla de subcategor칤as -->
      <ion-card class="row-header">
        <ion-grid fixed>
          <ion-row class="ion-text-center">
            <ion-col size="1">N춿</ion-col>
            <ion-col size="3">Subcategor칤a</ion-col>
            <ion-col size="6">Descripci칩n</ion-col>
            <ion-col size="2">Acciones</ion-col>
          </ion-row>
        </ion-grid>
      </ion-card>

      <!-- Lista de subcategor칤as -->
      <ion-card *ngFor="let subcategory of selectedCategory.subcategories; let indice = index" class="row-content">
        <ion-grid fixed>
          <ion-row class="ion-text-center">
            <ion-col size="1">{{ indice + 1 }}</ion-col>
            <ion-col size="3">{{ subcategory.name }}</ion-col>
            <ion-col size="6">{{ subcategory.description }}</ion-col>
            <ion-col size="2">
              <ion-icon name="pencil-outline" button tappable (click)="editarSubcategoria(subcategory)"
                class="pencil-icon">
              </ion-icon>
              <ion-icon name="trash" button tappable (click)="alertaEliminarSubcategoria(subcategory)"
                class="trash-icon">
              </ion-icon>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card>

      <!-- Bot칩n para agregar una nueva subcategor칤a -->
      <ion-button (click)="nuevaSubcategoria(selectedCategory.id)" expand="block" fill="outline" shape="round"
        class="add_subcategory_button">
        <ion-icon name="add" class="icon-add"></ion-icon>
        Agregar Subcategor칤a
      </ion-button>
    </ion-card>
  </ng-container>

  <!-- Formulario para agregar/editar una subcategor칤a -->

  <ion-modal [isOpen]="view_add_input">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button fill="outline" shape="round" (click)="guardarSubcategoria()">
              <ion-icon slot="start" name="pencil-outline"></ion-icon>
              {{ tipoBoton }}
            </ion-button>
          </ion-buttons>
          <ion-title class="ion-text-center">游늯</ion-title>
          <ion-buttons slot="end">
            <ion-button fill="outline" color="danger" shape="round" (click)="cancelarSubcategoria()">
              <ion-icon name="remove-circle-outline"></ion-icon>
              CANCELAR
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <br />
        <!-- Campo para el Nombre de la Subcategor칤a -->
        <ion-input label="Nombre de la Subcategor칤a" label-placement="stacked" fill="outline"
          placeholder="Nombre de la subcategor칤a" [(ngModel)]="name_subcategory" [disabled]="off_input">
        </ion-input>
        <br /><br />
        <ion-input label="Descripci칩n de la Subcategor칤a" label-placement="stacked" fill="outline"
          placeholder="Descripci칩n de la subcategor칤a" [(ngModel)]="description_subcategory" [disabled]="off_input">
        </ion-input>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>